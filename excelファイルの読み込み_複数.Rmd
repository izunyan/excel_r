# 複数のexcelファイルを読み込む
## 読み込むファイル名の一覧のオブジェクト作成

まず、読みこみたいファイルが格納されているフォルダのファイル名、およびパス名の一覧を取得します。

```{r}
files <-
    list.files(path = "data/複数/", full.names = TRUE)

files
```


`list.files()`関数は、`path = `で指定したフォルダ内の情報を取得します。`full.names = TRUE`でパスも含めます。これをつけないと、ファイル名と拡張子だけの取得になります。

## ファイルを一括で読み込む
```{r}
ldata <-
    map(files, ~read_xlsx(.))
```

ここでできた`ldata`は、\@ref(dflist)で作成した`df_list`と同じ構造です。違いはそれぞれのデータフレームの要素名（アデリー、ジェンツー、ヒゲ）が入っていない点です。これは不便なので、以下で要素名を改めてつけます。


### ファイル名抽出

先ほど作成した`files`から、ファイル名部分だけに加工します。`str_replace()`は、`stringr`パッケージの、文字の置換をする関数です。ここでは、拡張子とパス名をそれぞれ`""`、つまり空白に置換しています。

```{r}
file_name <- 
  str_replace(files, ".xlsx", "") %>% 
  str_replace("data/複数/", "")

file_name
```

### リストの要素名にファイル名を付与
```{r}
ldata <-
    set_names(ldata, file_name)

ldata
```

```{r  eval=FALSE, include=FALSE}
# 読みこんだデータ全体のリスト構造を表示
str(ldata,
    width = 80,   # 幅の指定
    vec.len = 2,  # 行数
    list.len = 3) # 列数
```

これらを1つのデータフレームにまとめるには、 \@ref(onedflist)と同じ手順でできます。


```{r eval = FALSE}
bind_rows(ldata, .id = "group")
```